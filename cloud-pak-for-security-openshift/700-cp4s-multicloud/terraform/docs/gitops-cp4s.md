# Cloud Pak for Security module

Module to populate a gitops repo with the resources to provision IBM Cloud Pak for Security


## Software dependencies

The module depends on the following software components:

### Terraform version

- \>= v0.15

### Terraform providers


- gitops (cloud-native-toolkit/gitops)

### Module dependencies


- gitops - [github.com/cloud-native-toolkit/terraform-tools-gitops.git](https://github.com/cloud-native-toolkit/terraform-tools-gitops.git) (>= 1.1.0)
- namespace - [github.com/cloud-native-toolkit/terraform-gitops-namespace.git](https://github.com/cloud-native-toolkit/terraform-gitops-namespace.git) (>= 1.0.0)
- catalogs - [github.com/cloud-native-toolkit/terraform-gitops-cp-catalogs.git](https://github.com/cloud-native-toolkit/terraform-gitops-cp-catalogs.git) (>= 1.0.0)
- serverless-operator - [github.com/cloud-native-toolkit/terraform-gitops-serverless-operator.git](https://github.com/cloud-native-toolkit/terraform-gitops-serverless-operator.git) (>= 1.0.0)
- knative-serving - [github.com/cloud-native-toolkit/terraform-gitops-knative-serving.git](https://github.com/cloud-native-toolkit/terraform-gitops-knative-serving.git) (>= 1.0.0)

## Example usage

```hcl
module "gitops-cp4s" {
  source = "github.com/cloud-native-toolkit/terraform-gitops-cp4s"

  admin_user = var.gitops-cp4s_admin_user
  backup_storage_class = var.rwo_storage_class
  backup_storage_size = var.gitops-cp4s_backup_storage_size
  catalog = module.gitops-cp-catalogs.catalog_ibmoperators
  catalog_namespace = var.gitops-cp4s_catalog_namespace
  channel = var.gitops-cp4s_channel
  domain = var.gitops-cp4s_domain
  entitlement_key = module.gitops-cp-catalogs.entitlement_key
  git_credentials = module.gitops_repo.git_credentials
  gitops_config = module.gitops_repo.gitops_config
  kubeseal_cert = module.gitops_repo.sealed_secrets_cert
  namespace = module.cp4s-namespace.name
  orchestration_automation_license = var.gitops-cp4s_orchestration_automation_license
  roks_auth = var.gitops-cp4s_roks_auth
  server_name = module.gitops_repo.server_name
  storage_class = var.rwo_storage_class
}

```

## Module details

### Inputs

| Name | Description | Required | Default | Source |
|------|-------------|---------|----------|--------|
| gitops_config | Config information regarding the gitops repo structure | true |  | gitops.gitops_config |
| git_credentials | The credentials for the gitops repo(s) | true |  | gitops.git_credentials |
| namespace | The namespace where the application should be deployed | true |  | namespace.name |
| kubeseal_cert | The certificate/public key used to encrypt the sealed secrets | true |  | gitops.sealed_secrets_cert |
| server_name | The name of the server | false | default | gitops.server_name |
| channel | The version of channel | false | v1.10 |  |
| storage_class | The provisioned block or file storage class for all the PVCs required by Cloud Pak for Security. When it is not specified, the default storage class is used. | true |  |  |
| roks_auth | Whether ROKS authentication need to be enabled | false | false |  |
| entitlement_key | Entitlement key value | true |  | catalogs.entitlement_key |
| admin_user | Short name or email-id of the user to be given administrator privileges in the default account. Mandatory value while creating cp4s-threat-management-instance | true |  |  |
| catalog | The catalog source that should be used to deploy the operator | false | ibm-operator-catalog | catalogs.catalog_ibmoperators |
| catalog_namespace | The namespace where the catalog has been deployed | false | openshift-marketplace |  |
| backup_storage_size | The storage size for the backup and restore PVC. Must be 500Gi or higher. If not specified, by default 500Gi is reserved. | true |  |  |
| backup_storage_class | Storage class for the backup and restore pod. If this value is not set, Cloud Pak for Security takes the value from the storageClass parameter. | true |  |  |
| domain | The fully qualified domain name (FQDN) created for Cloud Pak for Security. If you don't specify an FQDN, it is generated as cp4s.<cluster_ingress_subdomain>. | true |  |  |
| orchestration_automation_license | Orchestration & Automation license (leave blank if none) |  |  |  |

### Outputs

| Name | Description |
|------|-------------|
| name | The name of the module |
| branch | The branch where the module config has been placed |
| namespace | The namespace where the module will be deployed |
| server_name | The server where the module will be deployed |
| layer | The layer where the module is deployed |
| type | The type of module where the module is deployed |

## Resources

- [Documentation](https://operate.cloudnativetoolkit.dev)
- [Module catalog](https://modules.cloudnativetoolkit.dev)

> License: Apache License 2.0 | Generated by iascable (3.2.0)
